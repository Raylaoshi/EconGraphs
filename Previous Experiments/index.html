<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Previous Experiments — AP.Econ.Graphs</title>
  
  <!-- Fonts (Synchronized) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Noto+Sans+SC:wght@300;400;500;700&family=Outfit:wght@300;400;500;600;700&family=Syne:wght@700;800&display=swap" rel="stylesheet" />
  
  <style>
    /* ── THEME PALETTE (Synchronized) ── */
    :root {
      --bg: #fcfbf9;
      --ink: #050e3c;
      --mid: #002455;
      --faint: #f2f0eb;
      --line: #e6e4e0;
      --red: #DC0000;
      --red-dim: #fce8e8;
      --blue: #0057ff;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    
    body {
      background: var(--bg); color: var(--ink);
      font-family: 'Outfit', 'Noto Sans SC', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
      font-weight: 300; line-height: 1.7;
      -webkit-font-smoothing: antialiased;
      opacity: 0; transition: opacity 0.35s ease-in-out;
    }

    /* TYPOGRAPHY ADJUSTMENTS FOR CHINESE */
    :lang(zh) .page-desc {
      line-height: 1.8;
      letter-spacing: 0.02em;
    }

    /* ── TOPBAR ── */
    .topbar {
      position: sticky; top: 0; z-index: 100;
      z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 clamp(1rem,4vw,2rem); height: 64px;
      border-bottom: 1px solid var(--line);
      background: rgba(252,251,249,.95); backdrop-filter: blur(12px);
    }
    .logo {
      font-family: 'Syne', 'SF Pro Display', 'PingFang SC', 'Microsoft YaHei', sans-serif; font-weight: 800;
      font-size: clamp(.85rem,2vw,1.1rem); letter-spacing: -.02em;
      color: var(--ink); text-decoration: none;
    }
    .logo span { color: var(--red); }
    .topbar-right { display: flex; align-items: center; gap: 1rem; }
    .lang-toggle { display: flex; gap: 6px; }
    .lang-btn {
      background: none; border: 1px solid var(--line); border-radius: 6px;
      padding: .3rem .85rem; font-size: .78rem; font-family: inherit;
      cursor: pointer; color: var(--mid); transition: all .18s; font-weight: 500;
    }
    .lang-btn:hover { border-color: var(--mid); }
    .lang-btn.active { background: var(--ink); color: #fff; border-color: var(--ink); }

    /* ── PAGE HEADER & BREADCRUMBS ── */
    .page-header-wrap { border-bottom: 1px solid var(--line); background: #fff; }
    .page-header {
      max-width: 1100px; margin: 0 auto;
      padding: clamp(2rem,5vw,4rem) clamp(1rem,4vw,2rem) clamp(2rem,4vw,3rem);
    }
    .breadcrumb {
      font-size: .75rem; color: var(--mid);
      display: flex; align-items: center; gap: .4rem; flex-wrap: wrap;
      margin-bottom: 1.2rem;
    }
    .back-btn {
      display: inline-flex; align-items: center; gap: .4rem;
      background: var(--faint); border: 1px solid var(--line);
      color: var(--ink); text-decoration: none; 
      font-family: 'Outfit', sans-serif; 
      font-weight: 600; font-size: .85rem; padding: .5rem 1.1rem;
      border-radius: 6px; transition: all .18s; cursor: pointer;
    }
    .back-btn:hover { background: var(--ink); color: #fff; border-color: var(--ink); }
    
    .breadcrumb .sep { color: var(--line); font-size: .9rem; margin: 0 .2rem; }
    .breadcrumb .current-label { color: var(--mid); text-decoration: none; font-size: .85rem; }

    .page-eyebrow {
      font-size: clamp(.65rem,1.5vw,.75rem); letter-spacing: .15em;
      text-transform: uppercase; color: var(--mid);
      margin-bottom: 1rem; font-weight: 600;
    }
    .page-header h1 {
      font-family: 'Outfit', 'SF Pro Display', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      font-weight: 700;
      font-size: clamp(2.2rem,6vw,3.8rem); 
      letter-spacing: -.02em; 
      line-height: 1.1; 
      color: var(--ink); 
    }
    .page-desc {
      margin-top: 1.2rem; font-size: clamp(.95rem,2vw,1.05rem);
      color: var(--mid); max-width: 550px; line-height: 1.6;
    }

    /* ── MAIN CONTENT ── */
    main {
      max-width: 1100px; margin: 0 auto;
      padding: clamp(2.5rem,6vw,4rem) clamp(1rem,4vw,2rem) clamp(4rem,8vw,6rem);
    }

    /* STATUS */
    #status { padding: 4rem 0; text-align: center; color: var(--mid); font-size: .9rem; }
    .spinner {
      width: 18px; height: 18px;
      border: 2px solid var(--line); border-top-color: var(--red);
      border-radius: 50%; animation: spin .7s linear infinite;
      display: inline-block; margin-right: .5rem; vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* GRAPH LIST */
    .graph-list { list-style: none; }
    .graph-list li { border-bottom: 1px solid var(--line); }
    .graph-list li:first-child { border-top: 1px solid var(--line); }
    .graph-list li a {
      display: grid;
      grid-template-columns: 2.8rem 1fr auto;
      align-items: center; gap: clamp(.6rem,2vw,1.2rem);
      padding: clamp(.9rem,2vw,1.1rem) .4rem;
      text-decoration: none; color: var(--ink);
      transition: background .15s, padding-left .15s;
      border-radius: 4px;
    }
    .graph-list li a:hover {
      background: var(--faint); padding-left: .9rem;
    }
    .graph-label {
      font-family: 'DM Mono', monospace; font-size: .7rem;
      background: var(--faint); color: var(--mid);
      padding: .2rem .6rem; border-radius: 4px; white-space: nowrap;
      border: 1px solid var(--line);
      text-align: center; font-weight: 500;
    }
    .graph-title { font-size: clamp(.95rem,2vw,1.05rem); font-weight: 400; }
    .graph-arrow {
      color: var(--red); font-size: .9rem;
      opacity: 0; transition: opacity .2s;
    }
    .graph-list li a:hover .graph-arrow { opacity: 1; }

    /* EMPTY STATE */
    .empty-state { text-align: center; padding: 3rem 0; color: var(--mid); }

    /* FOOTER */
    .footer-wrap { border-top: 1px solid var(--line); background: #fff; }
    footer {
      max-width: 1100px; margin: 0 auto;
      padding: clamp(1.5rem,3vw,2rem) clamp(1rem,4vw,2rem);
      display: flex; flex-wrap: wrap; justify-content: space-between;
      align-items: center; gap: 1rem; font-size: .8rem; color: var(--mid);
    }
    footer a { color: var(--mid); text-decoration: none; transition: color .2s; }
    footer a:hover { color: var(--ink); }

    @media (max-width: 768px) {
      .page-header { padding-top: 2rem; padding-bottom: 2rem; }
    }
    @media (max-width: 480px) {
      .graph-list li a { grid-template-columns: 2.4rem 1fr; }
      .graph-arrow { display: none; }
    }
  </style>
</head>
<body>

<header class="topbar">
  <a class="logo" href="../index.html"><span>AP</span>·Econ·Graphs</a>
  <div class="topbar-right">
    <div class="lang-toggle">
      <button class="lang-btn active" id="btn-en" onclick="setLang('en')">EN</button>
      <button class="lang-btn" id="btn-zh" onclick="setLang('zh')">中文</button>
    </div>
  </div>
</header>

<div class="page-header-wrap">
  <div class="page-header">
    <div class="breadcrumb">
      <a class="back-btn" href="../index.html" data-i18n="backHome">⥃ Home</a>
      <span class="sep">/</span>
      <span class="current-label" data-i18n="breadcrumbCurrent">Previous Experiments</span>
    </div>
    <div class="page-eyebrow" data-i18n="eyebrow">Graph Archives</div>
    <h1 data-i18n="pageTitle">Previous Experiments</h1>
    <p class="page-desc" data-i18n="pageDesc">Earlier prototypes and exploratory graph models showing the evolution of this project.</p>
  </div>
</div>

<main>
  <div id="status"><span class="spinner"></span> <span data-i18n="loading">Loading…</span></div>
  <ul class="graph-list" id="graph-list" style="display:none"></ul>
</main>

<div class="footer-wrap">
  <footer>
    <span>AP.Econ.Graphs · <a href="https://github.com/Raylaoshi/AP.Econ.Graphs" target="_blank">github.com/Raylaoshi</a></span>
    <span data-i18n="footerCredit">Built with KineticGraphs by Chris Makler</span>
  </footer>
</div>

<script>
// ── Translations ──
const T = {
  en: {
    backHome:         '⥃ Back',
    breadcrumbCurrent:'Previous Experiments',
    eyebrow:          'Graph Archives',
    pageTitle:        'Previous Experiments',
    pageDesc:         'Earlier prototypes and exploratory graph models showing the evolution of this project. Click any file to open it.',
    loading:          'Loading…',
    footerCredit:     'Built with KineticGraphs by Chris Makler',
    emptyState:       'No files here yet.',
    errorMsg:         '⚠️ Could not load files from GitHub API.',
  },
  zh: {
    backHome:         '⥃ 返回',
    breadcrumbCurrent:'图表试验',
    eyebrow:          '图表归档',
    pageTitle:        '早期试验项目',
    pageDesc:         '一些早期的模型尝试与探索性图表，展示了本项目的演变过程。点击任意文件即可打开。',
    loading:          '加载中…',
    footerCredit:     '基于Chris Makler的KineticGraphs构建',
    emptyState:       '暂无文件。',
    errorMsg:         '⚠️ 无法从 GitHub API 加载文件列表。',
  }
};

const REPO   = 'Raylaoshi/AP.Econ.Graphs';
const FOLDER = 'Previous Experiments';

let currentLang = 'en';

function render(lang) {
  const t = T[lang];
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (typeof t[key] === 'string') el.textContent = t[key];
  });
  document.getElementById('btn-en').classList.toggle('active', lang === 'en');
  document.getElementById('btn-zh').classList.toggle('active', lang === 'zh');
  document.documentElement.lang = lang === 'zh' ? 'zh' : 'en';
}

function setLang(lang) {
  currentLang = lang;
  render(lang);
  try { localStorage.setItem('econ-lang', lang); } catch(e) {}
}

function detectLang() {
  try {
    const saved = localStorage.getItem('econ-lang');
    if (saved === 'en' || saved === 'zh') return saved;
  } catch(e) {}
  const nav = (navigator.language || '').toLowerCase();
  return nav.startsWith('zh') ? 'zh' : 'en';
}

async function init() {
  const statusEl = document.getElementById('status');
  const listEl   = document.getElementById('graph-list');

  currentLang = detectLang();
  render(currentLang);

  try {
    const res = await fetch(
      `https://api.github.com/repos/${REPO}/contents/${encodeURIComponent(FOLDER)}`
    );
    
    if (!res.ok) throw new Error(res.status);
    const files = await res.json();

    const htmlFiles = files.filter(f =>
      f.type === 'file' &&
      f.name.toLowerCase().endsWith('.html') &&
      f.name.toLowerCase() !== 'index.html'
    );

    statusEl.style.display = 'none';

    if (htmlFiles.length === 0) {
      statusEl.style.display = 'block';
      statusEl.innerHTML = `<div class="empty-state"><p>${T[currentLang].emptyState}</p></div>`;
      return;
    }

    listEl.style.display = 'block';

    htmlFiles.forEach((file, i) => {
      const displayName = file.name
        .replace(/\.html$/i, '')
        .replace(/[-_]/g, ' ');

      const num = String(i + 1).padStart(2, '0');
      const li = document.createElement('li');
      li.innerHTML = `
        <a href="${encodeURIComponent(file.name)}" target="_blank">
          <span class="graph-label">${num}</span>
          <span class="graph-title">${displayName}</span>
          <span class="graph-arrow">→</span>
        </a>`;
      listEl.appendChild(li);
    });

  } catch (err) {
    statusEl.innerHTML = `<div class="empty-state"><p>${T[currentLang].errorMsg}</p></div>`;
    console.error(err);
  }
}

// Fade in logic synchronized with other pages
document.addEventListener('DOMContentLoaded', function() {
    init();
});

document.fonts.ready.then(() => {
    document.body.style.opacity = '1';
});
setTimeout(() => { document.body.style.opacity = '1'; }, 800);

</script>
</body>
</html>